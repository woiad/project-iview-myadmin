webpackJsonp([4],{"3NKA":function(i,t){},ochg:function(i,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a("mvHQ"),s=a.n(e),o=a("ZoQJ"),n={name:"ipDefend",data:function(){var i=this;return{columnsData:[{title:"机房名称",key:"idc_ip_name"},{title:"IP地址",key:"idc_ip"},{title:"防护值 （单位：mb/s）",key:"idc_ip_bps",width:170},{title:"数据ID",key:"id"},{title:"牵引时间 (单位：分钟)",key:"idc_ip_tow_time",width:170},{title:"操作",width:150,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){i.modifierShow(a)}}},"修改"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){i.delShow(a)}}},"删除")])}}],loading:!0,ipDefendData:[],idcName:"",ip:"",idcList:[],buildShow:!1,buildData:{ip:"",idcIpBps:"",time:""},midifiShow:!1,modifierData:{time:"",idcIpBps:""},originData:{},delConfirm:!1,delData:{},pageNum:"",pageShow:!1,allData:[],currentPage:1,page:0}},methods:{getIdcData:function(){var i=this;this.$post("/webapi/public",{key:"idc_root"}).then(function(t){"{}"!==s()(t)&&t.forEach(function(t,a){i.idcList.push(t)}),i.loading=!1}).catch(function(i){console.log(i)})},getShowData:function(i,t){var a=this;this.loading=!0,this.$post("/webapi/ipfwset",{key:"ipshow",content:i}).then(function(i){a.ipDefendData=[],a.allData=[],"{}"!==s()(i)&&(console.log(i.length),i.forEach(function(i,t){a.ipDefendData.push(i),a.allData.push(i)})),i.length>10?(a.pageNum=i.length,a.pageShow=!0,a.currentPage===a.page?i.length%10!=0||t?a.ipDefendData=a.allData.slice(10*(a.page-1),10*a.page):(a.page-=1,a.currentPage-=1,a.ipDefendData=a.allData.slice(10*(a.page-1),10*a.page)):a.ipDefendData=a.allData.slice(0,10)):i.length<=10&&(a.pageShow=!1),a.loading=!1}).catch(function(i){console.log(i)})},ipQuery:function(i){var t={};if(""===this.idcName&&""===this.ip)return alert("请输入机房名称或IP地址"),!0;if(!o.a.regIp(this.ip)&&""!==this.ip)return alert("输入IP格式不正确"),!0;if(""!==this.idcName)for(var a=0;a<this.idcList.length;a++)this.idcName===this.idcList[a].idc_name&&(t.idc_id_root=this.idcList[a].id);else t.idc_id_root=1;""!==this.ip?t.ip=this.ip:t.ip="";var e=s()(t);this.getShowData(e,i)},bulidIp:function(){this.buildShow=!0},buildCancel:function(){this.buildData.idcName="",this.buildData.ip="",this.buildData.idcIpBps="",this.buildData.time=""},submitData:function(){var i=this,t={};if(""===this.buildData.ip||""===this.buildData.idcIpBps||""===this.buildData.time)return alert("请填写完整资料！"),!0;if(!o.a.regIp(this.buildData.ip)&&""!==this.buildData.ip)return alert("IP格式不正确！"),!0;t.ip=this.buildData.ip,t.time=this.buildData.time,t.idc_ip_bps=this.buildData.idcIpBps;var a=s()(t);this.$post("/webapi/ipfwset",{key:"ipadd",content:a}).then(function(a){403===a[1]?alert(a[2]):200===a[1]&&(i.$Message.info("提交成功！"),i.buildCancel(),i.buildShow=!1,i.showAddIp(t.ip),""!==i.idcName&&i.ipQuery())}).catch(function(t){i.$Message.info("提交失败"+t)})},showAddIp:function(i){var t=this,a={};a.ip=i,a.idc_id_root="",this.$post("/webapi/ipfwset",{key:"ipshow",content:s()(a)}).then(function(i){s()(i)!=={}&&t.ipDefendData.unshift(i[0])}).catch(function(i){t.$Message.error(i),console.log(i)})},modifierShow:function(i){var t=this;this.originData={},this.ipDefendData.forEach(function(a,e){e===i.index&&(t.originData=a)}),this.midifiShow=!0},modifierCancel:function(){this.modifierData.time="",this.modifierData.idcIpBps=""},submitModifierData:function(){var i=this,t={};if(""===this.modifierData.time&&""===this.modifierData.idcIpBps)return alert("请修改后再提交！"),!0;""!==this.modifierData.time?t.time=this.modifierData.time:t.time=this.originData.idc_ip_tow_time,""!==this.modifierData.idcIpBps?t.idc_ip_bps=this.modifierData.idcIpBps:t.idc_ip_bps=this.originData.idc_ip_bps,t.ip=this.originData.idc_ip,t.id=this.originData.id;var a=s()(t);this.$post("/webapi/ipfwset",{key:"ipupdate",content:a}).then(function(t){i.$Message.info("修改成功"),i.modifierCancel(),i.currentPage=i.page,i.midifiShow=!1,i.ipQuery("modify")}).catch(function(t){i.$Message.info("修改失败"+t)})},delShow:function(i){this.delConfirm=!0,this.delData=i.row},confirmDel:function(){var i=this,t=this.delData.id;this.$post("/webapi/ipfwset",{key:"ipdel",id:t}).then(function(t){i.$Message.info("删除成功！"),i.delConfirm=!1,i.currentPage=i.page,i.ipQuery()}).catch(function(t){i.$Message.info("删除失败"+t)})},pageChange:function(i){this.page=i,this.ipDefendData=this.allData.slice(10*(i-1),10*i)}},mounted:function(){this.getIdcData()}},l={render:function(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",{staticClass:"ipDefend-container"},[a("div",{staticClass:"build"},[a("Button",{attrs:{type:"primary",icon:"ios-plus-empty"},on:{click:i.bulidIp}},[i._v("IP新建")])],1),i._v(" "),a("div",{staticClass:"query"},[a("div",{staticClass:"query-idcName"},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择机房"},model:{value:i.idcName,callback:function(t){i.idcName=t},expression:"idcName"}},i._l(i.idcList,function(t,e){return a("Option",{key:e,attrs:{value:t.idc_name}},[i._v(i._s(t.idc_name))])}))],1),i._v(" "),a("div",{staticClass:"query-ip"},[a("i-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入IP"},model:{value:i.ip,callback:function(t){i.ip=t},expression:"ip"}}),i._v(" "),a("div",{staticClass:"but"},[a("Button",{attrs:{type:"primary"},on:{click:i.ipQuery}},[i._v("查询")])],1)],1)]),i._v(" "),a("div",{staticClass:"table"},[a("i-table",{attrs:{columns:i.columnsData,data:i.ipDefendData,loading:i.loading}})],1),i._v(" "),a("div",{staticClass:"modal"},[a("Modal",{attrs:{title:"新建IP"},on:{"on-cancel":i.buildCancel},model:{value:i.buildShow,callback:function(t){i.buildShow=t},expression:"buildShow"}},[a("div",{staticClass:"text"},[a("div",{staticClass:"item"},[a("label",[i._v("IP地址")]),i._v(" "),a("i-input",{attrs:{placeholder:"请输入IP地址"},model:{value:i.buildData.ip,callback:function(t){i.$set(i.buildData,"ip",t)},expression:"buildData.ip"}})],1),i._v(" "),a("div",{staticClass:"item"},[a("label",[i._v("IP防护值 (单位： mb/s)")]),i._v(" "),a("i-input",{attrs:{placeholder:"请输入IP防护值"},model:{value:i.buildData.idcIpBps,callback:function(t){i.$set(i.buildData,"idcIpBps",t)},expression:"buildData.idcIpBps"}})],1),i._v(" "),a("div",{staticClass:"item"},[a("label",[i._v("IP牵引时间 (单位： 分钟)")]),i._v(" "),a("i-input",{attrs:{placeholder:"请输入IP牵引时间"},model:{value:i.buildData.time,callback:function(t){i.$set(i.buildData,"time",t)},expression:"buildData.time"}})],1)]),i._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:i.buildCancel}},[i._v("重置")]),i._v(" "),a("Button",{attrs:{primary:"default"},on:{click:i.submitData}},[i._v("提交")])],1)]),i._v(" "),a("Modal",{attrs:{title:"修改IP"},on:{"on-cancel":i.modifierCancel},model:{value:i.midifiShow,callback:function(t){i.midifiShow=t},expression:"midifiShow"}},[a("div",{staticClass:"text"},[a("div",{staticClass:"item"},[a("label",[i._v("IP防护值 (单位： mb/s)")]),i._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:i.modifierData.idcIpBps,expression:"modifierData.idcIpBps"}],staticClass:"inp",attrs:{placeholder:i.originData.idc_ip_bps},domProps:{value:i.modifierData.idcIpBps},on:{input:function(t){t.target.composing||i.$set(i.modifierData,"idcIpBps",t.target.value)}}})]),i._v(" "),a("div",{staticClass:"item"},[a("label",[i._v("牵引时间 (单位： 分钟)")]),i._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:i.modifierData.time,expression:"modifierData.time"}],staticClass:"inp",attrs:{placeholder:i.originData.idc_ip_tow_time},domProps:{value:i.modifierData.time},on:{input:function(t){t.target.composing||i.$set(i.modifierData,"time",t.target.value)}}})])]),i._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:i.modifierCancel}},[i._v("重置")]),i._v(" "),a("Button",{attrs:{type:"primary"},on:{click:i.submitModifierData}},[i._v("提交")])],1)]),i._v(" "),a("Modal",{attrs:{width:"360"},model:{value:i.delConfirm,callback:function(t){i.delConfirm=t},expression:"delConfirm"}},[a("p",{staticStyle:{color:"rgb(255, 102, 0)","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),i._v(" "),a("span",[i._v("删除确认")])],1),i._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("p",[i._v("该ip一经删除，无法恢复")])]),i._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:""},on:{click:i.confirmDel}},[i._v("删除")])],1)])],1),i._v(" "),a("div",{staticClass:"page"},[i.pageShow?a("Page",{attrs:{total:i.pageNum,"show-elevator":"",current:i.currentPage},on:{"on-change":i.pageChange}}):i._e()],1)])},staticRenderFns:[]};var c=a("VU/8")(n,l,!1,function(i){a("3NKA")},"data-v-96787532",null);t.default=c.exports}});
//# sourceMappingURL=4.7b17363024ee356f4fd5.js.map